<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin=anonymous referrerpolicy=no-referrer><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin=anonymous></script><meta name=viewport content="width=device-width,initial-scale=1"><script src=https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4></script><link rel=preconnect href=https://fonts.bunny.net><link href="https://fonts.bunny.net/css?family=ibm-plex-sans:300,400,400i,500,500i,600,700,700i" rel=stylesheet><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script>window.MathJax={loader:{load:["[tex]/physics"]},tex:{packages:{"[+]":["physics"]}}}</script><title>filesystem</title>
<meta name=description content="The filesystem is the only thing that can store anything across power offs.
disk
Unlike memory, its &ldquo;sector-addressable&rdquo;: you cannot read or write individual bytes. The disk is divided into sectors, which you have to wholesale read and write.
seeking
Because disks are mostly moving, reading and writing requires seeking: to wait until the platter go under the arm and read.
filesystems are designed to minimize the seek time.
functionality

creating
looknig up
reading: sequential + random file access; access either all of a file or a part of the file
editing
creating folders

main challenges

disk space management: minimize seeks, sharing space, efficient use of disk
naming: how do users name files
reliability: surviving OS crashes and hardware failures
protection: isolation between users, controlled sharing

block
a block is a group of one or more sectors, which issued to abstract away chunks of sectors."><meta name=author content="Houjun Liu"><link rel=stylesheet href=/css/all.css><link rel=stylesheet href=/css/page.css><link rel=stylesheet href=/css/syntax.css><link rel=stylesheet href=/css/typography.css><link rel=stylesheet href=/css/components.css></head><body><div class="center-clearfix p-10" style="max-width:1200px;margin:0 auto"><header class=pb-4><span class="w-full flex justify-between flex-wrap"><div style=font-weight:600;font-size:15px><a style=border:0;cursor:pointer href=/><img src=/images/Logo_Transparent.png style=width:17px;display:inline-block;margin-right:8px;transform:translateY(-2.7px)></a>filesystem</div><span style="float:right;display:flex;align-items:center;margin-top:5px;width:100%;max-width:400px;background:#fff;border-radius:2px;border:1px solid var(--gray-2);position:relative"><i class="fa-solid fa-magnifying-glass" style=font-size:12px;color:var(--yellow-fg);margin-right:7px;margin-left:10px></i><div style=width:100%><input id=search-query-inline name=s type=text autocomplete=off placeholder="Search Knowledgebase" enterkeyhint=search></div><div id=search-result-inline style=display:none></div><script id=search-result-template type=text/x-js-template data-template=searchresult>
    <a href="${link}" class="search-link">
    <div class="search-result-item" id="search-result-item-${key}">
        <div class="search-result-title">${title}</div>
        <div class="search-result-summary">${snippet}</div>
    </div>
    </a>
</script><script src=https://code.jquery.com/jquery-3.3.1.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.0/fuse.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js></script><script type=module>
    import { create, insertMultiple, search } from 'https://cdn.jsdelivr.net/npm/@orama/orama@latest/+esm'
    let template = $('script[data-template="searchresult"]').text().split(/\$\{(.+?)\}/g);

    function render(props) {
        return function(tok, i) { return (i % 2) ? props[tok] : tok; };
    }

    const db = create({
        schema: {
            title: 'string',
            content: 'string',
        },
    });
    $.get("https://www.jemoka.com/index.json", function(data, status){
        insertMultiple(db, data.map(x =>
            ({title: x.title, content: x.contents, link: x.permalink})));
    });
    $("#search-result-inline").attr("tabindex", "-1");
    $(document).on("click", function (e) {
    if (!$(e.target).closest("#search-query-inline, #search-result-inline").length) {
        $("#search-result-inline").hide();
    }
    });
    
    
    
    
    
    

    $("#search-query-inline").on("focus keyup", function () {
        let value = $(this).val();
        if (value.trim() == "") {
            $("#search-result-inline").html("");
            $("#search-result-inline").hide();
            return;
        }
        $("#search-result-inline").show();
        let results = search(db, {mode: "fulltext", term: value});
        let contents = results.hits.map(x => template.map(render({
            title: x.document.title,
            snippet: x.document.content.slice(0, 52),
            key: x.id,
            link: x.document.link
        })).join(''));
        $("#search-result-inline").html(contents.join("\n"));
        
    });
    if (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {
        $('#search-query-inline').on('focus', function(){
            
            $(this).data('fontSize', $(this).css('font-size')).css('font-size', '16px');
        }).on('blur', function(){
            
            $(this).css('font-size', $(this).data('fontSize'));
        });
    }

</script></span></span><div class=w-full style="padding-bottom:4px;border-bottom:1px solid var(--gray-1);margin-top:1px"></div></header><aside id=tocbox><div id=heading style=padding-left:40px;font-weight:600;font-size:11px;color:var(--gray-3)>contents</div><div id=toc></div></aside><main><article><div style=max-width:700px><p>The <a href=/posts/kbhfilesystem/>filesystem</a> is the only thing that can store anything across power offs.</p><h2 id=disk>disk</h2><p>Unlike memory, its &ldquo;sector-addressable&rdquo;: you cannot read or write individual bytes. The <a href=#disk>disk</a> is divided into <a href=#disk>sector</a>s, which you have to wholesale read and write.</p><h3 id=seeking>seeking</h3><p>Because disks are mostly moving, reading and writing requires <a href=#seeking>seeking</a>: to wait until the platter go under the arm and read.</p><p><a href=/posts/kbhfilesystem/>filesystem</a>s are designed to minimize the seek time.</p><h2 id=functionality>functionality</h2><ul><li>creating</li><li>looknig up</li><li>reading: sequential + random file access; access either all of a file or a part of the file</li><li>editing</li><li>creating folders</li></ul><h3 id=main-challenges>main challenges</h3><ul><li><strong>disk space management</strong>: minimize seeks, sharing space, efficient use of disk</li><li><strong>naming</strong>: how do users name files</li><li><strong>reliability</strong>: surviving OS crashes and hardware failures</li><li><strong>protection</strong>: isolation between users, controlled sharing</li></ul><h2 id=block>block</h2><p>a <a href=#block>block</a> is a group of one or more <a href=#disk>sector</a>s, which issued to abstract away chunks of sectors.</p><h2 id=fragmentation>fragmentation</h2><h3 id=internal-fragmentation>internal fragmentation</h3><p>A file can be no less than a single <a href=#block>block</a> of text.</p><h3 id=external-fragmentation>external fragmentation</h3><p>&ldquo;no space is available even if the space in aggregate is available&rdquo;</p><h2 id=models-of-storage>models of storage</h2><p>We typically put two things into the block:</p><ul><li>file payload data</li><li>file meta-data</li></ul><p>there is a few ways to do this:</p><ul><li><a href=/posts/kbhcontiguous_allocation/>contiguous allocation</a></li><li><a href=/posts/kbhlinked_files/>linked files</a></li><li><a href=/posts/kbhwindows_fat/>Windows FAT</a></li><li><a href=/posts/kbhfile_payload_data/>File Payload Data</a></li><li><a href=/posts/kbhunix_v6_filesystem/>Unix V6 Filesystem</a>: <a href=/posts/kbhunix_v6_filesystem/>inode</a>, <a href=#block>block</a>, <a href=/posts/kbhunix_v6_filesystem/#block-cache>Block Cache</a></li></ul></div></article></main><footer style=margin-top:20px><p id=footer style=font-size:8px;color:var(--gray-3)>&copy; 2019-2025 Houjun Liu. Licensed CC BY-NC-SA 4.0.</p></footer></div><script src=https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.32.2/tocbot.min.js></script><script>tocbot.init({tocSelector:"#toc",contentSelector:".center-clearfix",headingSelector:"h1, h2, h3",hasInnerContainers:!0})</script></body></html>